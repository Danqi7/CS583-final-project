---

title: Eval


keywords: fastai
sidebar: home_sidebar

summary: "API details"
description: "API details"
nb_path: "10_eval.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: 10_eval.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="generate_points" class="doc_header"><code>generate_points</code><a href="https://github.com/dsm-72/ToyTrajectoryNet/tree/main/ToyTrajectoryNet/eval.py#L10" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>generate_points</code>(<strong><code>model</code></strong>, <strong><code>df</code></strong>, <strong><code>n_points</code></strong>=<em><code>100</code></em>, <strong><code>sample_with_replacement</code></strong>=<em><code>False</code></em>, <strong><code>use_cuda</code></strong>=<em><code>False</code></em>, <strong><code>samples_key</code></strong>=<em><code>'samples'</code></em>, <strong><code>sample_time</code></strong>=<em><code>None</code></em>, <strong><code>autoencoder</code></strong>=<em><code>None</code></em>)</p>
</blockquote>
<h2 id="Arguments:">Arguments:<a class="anchor-link" href="#Arguments:"> </a></h2>
<pre><code>model (torch.nn.Module): Trained network with the property [`ode`](/ToyTrajectoryNet/ode.html) corresponding to a `NeuralODE(ODEF())`.
    See `ToyTrajectoryNet.ode` for more.
df (pd.DataFrame): DataFrame containing a column for the timepoint samples and the rest of the data.
n_points (int): Number of points to generate.
sample_with_replacement (bool): Defaults to `False`. Whether or not to use replacement when sampling
    initial timepoint.
use_cuda (bool): Defaults to `False`. Whether or not to use cuda.
samples_key (str): Defaults to `'samples'`. The column in the `df` which has the timepoint groups.
sample_time (list | None): Defaults to `None`. If `None` uses the group numbers in order as the
    timepoints as specified in the column `df[samples_key]`.
</code></pre>
<h2 id="Returns:">Returns:<a class="anchor-link" href="#Returns:"> </a></h2>
<pre><code>generated (float[float[]]): a list with shape `(len(sample_time), n_points, len(df.columns) - 1)`
    of the generated points.</code></pre>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="generate_trajectories" class="doc_header"><code>generate_trajectories</code><a href="https://github.com/dsm-72/ToyTrajectoryNet/tree/main/ToyTrajectoryNet/eval.py#L49" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>generate_trajectories</code>(<strong><code>model</code></strong>, <strong><code>df</code></strong>, <strong><code>n_trajectories</code></strong>=<em><code>30</code></em>, <strong><code>n_bins</code></strong>=<em><code>100</code></em>, <strong><code>sample_with_replacement</code></strong>=<em><code>False</code></em>, <strong><code>use_cuda</code></strong>=<em><code>False</code></em>, <strong><code>samples_key</code></strong>=<em><code>'samples'</code></em>, <strong><code>autoencoder</code></strong>=<em><code>None</code></em>)</p>
</blockquote>
<h2 id="Arguments:">Arguments:<a class="anchor-link" href="#Arguments:"> </a></h2>
<pre><code>model (torch.nn.Module): Trained network with the property [`ode`](/ToyTrajectoryNet/ode.html) corresponding to a `NeuralODE(ODEF())`.
    See `ToyTrajectoryNet.ode` for more.
df (pd.DataFrame): DataFrame containing a column for the timepoint samples and the rest of the data.
n_trajectories (int): Number of trajectories to generate.
n_bins (int): Number of bins to use for the trajectories. More makes it smoother. Defaults to `100`.
sample_with_replacement (bool): Defaults to `False`. Whether or not to use replacement when sampling
    initial timepoint.
use_cuda (bool): Defaults to `False`. Whether or not to use cuda.
samples_key (str): Defaults to `'samples'`. The column in the `df` which has the timepoint groups.
</code></pre>
<h2 id="Returns:">Returns:<a class="anchor-link" href="#Returns:"> </a></h2>
<pre><code>trajectories (float[float[]]): a list with shape `(n_bins, n_points, len(df.columns) - 1)`
    of the generated trajectories.</code></pre>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="generate_plot_data" class="doc_header"><code>generate_plot_data</code><a href="https://github.com/dsm-72/ToyTrajectoryNet/tree/main/ToyTrajectoryNet/eval.py#L75" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>generate_plot_data</code>(<strong><code>model</code></strong>, <strong><code>df</code></strong>, <strong><code>n_points</code></strong>, <strong><code>n_trajectories</code></strong>, <strong><code>n_bins</code></strong>, <strong><code>sample_with_replacement</code></strong>=<em><code>False</code></em>, <strong><code>use_cuda</code></strong>=<em><code>False</code></em>, <strong><code>samples_key</code></strong>=<em><code>'samples'</code></em>, <strong><code>logger</code></strong>=<em><code>None</code></em>, <strong><code>autoencoder</code></strong>=<em><code>None</code></em>)</p>
</blockquote>
<h2 id="Arguments:">Arguments:<a class="anchor-link" href="#Arguments:"> </a></h2>
<pre><code>model (torch.nn.Module): Trained network with the property [`ode`](/ToyTrajectoryNet/ode.html) corresponding to a `NeuralODE(ODEF())`.
    See `ToyTrajectoryNet.ode` for more.
df (pd.DataFrame): DataFrame containing a column for the timepoint samples and the rest of the data.
n_points (int): Number of points to generate.
n_trajectories (int): Number of trajectories to generate.
n_bins (int): Number of bins to use for the trajectories. More makes it smoother. Defaults to `100`.
sample_with_replacement (bool): Defaults to `False`. Whether or not to use replacement when sampling
    initial timepoint.
use_cuda (bool): Defaults to `False`. Whether or not to use cuda.
samples_key (str): Defaults to `'samples'`. The column in the `df` which has the timepoint groups.
</code></pre>
<h2 id="Returns:">Returns:<a class="anchor-link" href="#Returns:"> </a></h2>
<pre><code>points (float[float[]]): a list with shape `(len(df[sample_key].unique()), n_points, len(df.columns) - 1)`
    of the generated points.
trajectories (float[float[]]): a list with shape `(n_bins, n_points, len(df.columns) - 1)`
    of the generated trajectories.</code></pre>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="get_points_from_trajectories" class="doc_header"><code>get_points_from_trajectories</code><a href="https://github.com/dsm-72/ToyTrajectoryNet/tree/main/ToyTrajectoryNet/eval.py#L115" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>get_points_from_trajectories</code>(<strong><code>n_groups</code></strong>:<code>int</code>, <strong><code>trajectories</code></strong>:<code>Union</code>[<code>ndarray</code>, <code>list</code>], <strong><code>how</code></strong>:<code>Union</code>[Literal['start']<code>, Literal['middle']</code>, Literal['end']<code>\]=*</code>'start'<code>*, **</code>logger<code>**:</code>Logger<code>=*</code>None`*)</p>
</blockquote>
<p>Arguments:
    n_groups (int): how many time points there are total.
    trajectories (np.ndarray | list): A list with three dimensions that correspond to:
        <code>(n_bins, n_points, n_dims)</code>, where <code>n_points</code> are the number of points / trajectories there are,
        <code>n_bins</code> correponds to how the trajectories were smoothed via binning (e.g. if there were 5 total
        time points one might have 100 bins to draw a smoother line when plotting), and <code>n_dims</code> are the
        number of dimensions the points are in (e.g. 2).
    how (str): Defaults to <code>'start'</code>. How to extract the point for the binned trajectories.
        If <code>'start'</code> takes the first point in the time window. If <code>'middle'</code> takes the floored averaged.
        If <code>'end'</code> takes the the last point in the time window.
    logger (logging.Logger): Defaults to <code>None</code>.
Returns:
    points (np.ndarray): Points at the corresponding indicices. If <code>trajectories</code> has shape:
        <code>(n_bins, n_points, n_dims)</code>, this will have shape <code>(n_groups, n_points, n_dims)</code>.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="calculate_nn" class="doc_header"><code>calculate_nn</code><a href="https://github.com/dsm-72/ToyTrajectoryNet/tree/main/ToyTrajectoryNet/eval.py#L170" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>calculate_nn</code>(<strong><code>df</code></strong>:<code>DataFrame</code>, <strong><code>generated</code></strong>:<code>Union</code>[<code>ndarray</code>, <code>list</code>]=<em><code>None</code></em>, <strong><code>trajectories</code></strong>:<code>Union</code>[<code>ndarray</code>, <code>list</code>]=<em><code>None</code></em>, <strong><code>compare_to</code></strong>:<code>Union</code>[Literal['time']<code>, Literal['any']</code>]=<em><code>'time'</code></em>, <strong><code>how</code></strong>:<code>Union</code>[Literal['start']<code>, Literal['middle']</code>, Literal['end']<code>\]=*</code>'start'<code>*, **</code>k<code>**:</code>int<code>=*</code>1<code>*, **</code>groups<code>**:</code>Union<code>\[</code>ndarray<code>,</code>list<code>\]=*</code>None<code>*, **</code>sample_key<code>**:</code>str<code>=*</code>'samples'<code>*, **</code>method<code>**:</code>str<code>=*</code>'mean'<code>*, **</code>logger<code>**:</code>Logger<code>=*</code>None`*)</p>
</blockquote>
<p>Arguments:
    df (pd.DataFrame): DataFrame containing all points and time sample specified by <code>sample_key</code>
    generated (np.ndarray | list): A list of the generate points with shape
        <code>(n_groups, n_points, n_dims)</code>, where <code>n_groups</code> is the total number of time indicies
        as specified in <code>groups</code>.
    trajectories (np.ndarray | list): A list with three dimensions that correspond to:
        <code>(n_bins, n_points, n_dims)</code>, where <code>n_points</code> are the number of points / trajectories there are,
        <code>n_bins</code> correponds to how the trajectories were smoothed via binning (e.g. if there were 5 total
        time points one might have 100 bins to draw a smoother line when plotting), and <code>n_dims</code> are the
        number of dimensions the points are in (e.g. 2).
    compare_to (str): Defaults to <code>'time'</code>. Determines points to use for KNN. If <code>'time'</code> will only
        consider points at the same time index. If <code>'any'</code> will search for nearest points regardless
        of time.
    how (str): Defaults to <code>'start'</code>. How to extract the point for the binned trajectories.
        If <code>'start'</code> takes the first point in the time window. If <code>'middle'</code> takes the floored averaged.
        If <code>'end'</code> takes the the last point in the time window.
    k (int): Defaults to <code>1</code>. Number of points to compare predicted points in <code>generated</code>
        or <code>trajectories</code> to.
    groups (np.ndarray | list): Defaults to <code>None</code> and will be extracted from <code>df</code> is not provided.
        The sorted unique values of time samples from <code>df</code> as specified by <code>sample_key</code>.
    sample_key (str): Defaults to <code>'samples'</code>. The column in <code>df</code> which corresponds to the time index.
    method (str): Defaults to <code>'mean'</code>. If <code>'mean'</code> returns the mean of the knn distances. If <code>'quartile'</code>
        returns the mean of the worst (highest distances) quartile.
    logger (logging.Logger): Defaults to <code>None</code>.
Returns:
    mean_dist (float): mean distance of predicted points to the <code>n</code> nearest-neighbor points.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

</div>
 

